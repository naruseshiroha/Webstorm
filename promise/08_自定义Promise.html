<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>08_自定义Promise</title>
</head>

<body>

<script type="text/javascript" src="./lib/Promise.js"></script>
<!--<script type="text/javascript">
    const p = new Promise((resolve, reject) => {
        setTimeout(() => {
            // resolve(1)
            reject(2)
            console.log("reject()改变状态之后")
        }, 1)
    })

    p.then(
        value => {
            console.log("onResolved1()",value)
        },
        reason => {
            console.log("onRejected1()",reason)
        }
    )

    p.then(
        value => {
            console.log("onResolved2()",value)
        },
        reason => {
            console.log("onRejected2()",reason)
        }
    )
</script>-->
<!--<script type="text/javascript">
    const p = new Promise((resolve, reject) => {
        setTimeout(() => {
            // resolve(1)
            reject(2)
        }, 1)
    }).then(
        value => {
            console.log("onResolved1()", value)
        },
        reason => {
            console.log("onRejected1()", reason)
            // return 3
            // throw 4
            return new Promise((resolve, reject) => reject(5))
        }
    ).then(
        value => {
            console.log("onResolved2()", value)
        },
        reason => {
            console.log("onRejected2()", reason)
            throw 6
        }
    ).catch(reason => {
        console.log("onRejected3()")
        return new Promise(() => {
        })
    }).then(
        value => {
            console.log("onResolved4()", value)
        },
        reason => {
            console.log("onRejected4()", reason)
        }
    )
</script>-->

<script type="text/javascript">
    const p1 = Promise.resolve(2)
    const p2 = Promise.resolve(Promise.resolve(3))
    const p3 = Promise.resolve(Promise.reject(4))
    const p4 = new Promise(resolve => {
        setTimeout(() => {
            resolve(5)
        }, 1000)
    })
    const p5 = Promise.reject(6)
    /*p1.then(
        value => {
            console.log("p1", value)
        }
    )

    p2.then(
        value => {
            console.log("p2", value)
        }
    )

    p3.catch(
        reason => {
            console.log("p3", reason)
        }
    )*/

    // const pAll = Promise.all([p1, p2, p3])
    // const pAll = Promise.all([p4, p5, p1, p2])
    /*pAll.then(
        values => {
            console.log("all onResolved()", values)
        },
        reason => {
            console.log("all onRejected()", reason)
        }
    )*/

    // const pRace = Promise.race([p1, p2, p3])
    const pRace = Promise.race([p4, p5, p2, p3])
    pRace.then(
        value => {
            console.log("race onResolved()", value)
        },
        reason => {
            console.log("race onRejected()", reason)
        }
    );

</script>
</body>

</html>